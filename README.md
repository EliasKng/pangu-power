# pangu-pytorch

This represents our initial attempt to replicate the Pangu-Weather model as detailed in the work by Bi et al. (2023). Our implementation closely adheres to the pseudocode provided in the GitHub repository at https://github.com/198808xc/Pangu-Weather. We have made specific adjustments to certain components, such as the PatchEmbedding and PatchRecovery layers, in alignment with the pretrained weights available in ONNX files. Notably, the attention mask is not utilized in our current implementation.

It is worth noting that there exists a significant performance gap between the accuracy achieved with our reconstructed model and the reported accuracy in the original paper. We are actively working on further enhancements to bridge this gap. The pretrained weights in PyTorch format are available upon request.

To assess the accuracy of our model, we conducted comparative tests focusing on the 24-hour horizon scores. These comparisons involve the scores reported in the original paper, the scores computed using the pretrained weights (in onnx file), and the scores generated by our reconstructed model. The tests were conducted on 2018 ERA5 data, specifically sampled at 00:00 UTC and 12:00 UTC.

<p align="center">
  <img src="res/vis.png" width="350" title="hover text">
  <img src="res/vis_onnx.png" width="350" alt="accessibility text">
</p>


<p align="center">
  <img src="res/vis.png" width="350" title="hover text">
  <img src="res/vis_onnx.png" width="350" alt="accessibility text">
</p>
